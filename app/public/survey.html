<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Find a Friend!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Baloo%7CRoboto">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha384-xBuQ/xzmlsLoJpyjoggmTEz8OWUFM0/RC5BsqQBDX2v5cMvDHcMakNTNrHIW2I5f" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container content">
        <h1>Friend Survey</h1>
        <h2>Which potential friend are you the most compatible with? Find out now!</h2>
        <form>
            <div class="form-group">
                <input id="name" type="text" class="form-control" placeholder="Name (Required)">
            </div>
            <div class="form-group">
                <input id="photo" type="text" class="form-control" placeholder="Link to Profile Photo (Required)">
            </div>
            <div class="form-group">
                <h3><strong>Question 1</strong></h3>
                <h4>I like challenges.</h4>
                <select data-placeholder="" class="chosen-select" id="q1">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 2</strong></h3>
                <h4>I am creative.</h4>
                <select data-placeholder="" class="chosen-select" id="q2">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 3</strong></h3>
                <h4>I value money.</h4>
                <select data-placeholder="" class="chosen-select" id="q3">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 4</strong></h3>
                <h4>I like animals.</h4>
                <select data-placeholder="" class="chosen-select" id="q4">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 5</strong></h3>
                <h4>I like being in nature.</h4>
                <select data-placeholder="" class="chosen-select" id="q5">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 6</strong></h3>
                <h4>I am reliable.</h4>
                <select data-placeholder="" class="chosen-select" id="q6">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 7</strong></h3>
                <h4>I like to party</h4>
                <select data-placeholder="" class="chosen-select" id="q7">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 8</strong></h3>
                <h4>I prioritize well.</h4>
                <select data-placeholder="" class="chosen-select" id="q8">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 9</strong></h3>
                <h4>I like to explore new places.</h4>
                <select data-placeholder="" class="chosen-select" id="q9">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <h3><strong>Question 10</strong></h3>
                <h4>I am energized by crowds.</h4>
                <select data-placeholder="" class="chosen-select" id="q10">
                    <option label=" "></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2 (Somewhat Disagree)</option>
                    <option value="3">3 (Average)</option>
                    <option value="4">4 (Somewhat Agree)</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
        </form>
        <div class="text-center">
            <button id="submit" type="submit" class="btn btn-lg btn-info active" aria-pressed="true">Submit</button>
        </div>
    </div>
    <footer class="footer">
        <div class="container">
            <p><a href="/api/friends">Friend Finder API</a> | <a href="https://github.com/Edestiny7/FriendFinder">GitHub Repo</a></p>
        </div>
    </footer>

    <!-- Modal appears after successful survey submission-->
    <div id="bestFriendModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title"><strong>Possible New Friend!</strong></h2>
                    <button type="button" class="close" data-dismiss="modal">
                                    &times;
                                </button>
                </div>
                <div class="modal-body">
                    <h2 id="bestFriendName"></h2>
                    <img id="bestFriendImg" src="https://via.placeholder.com/400x400" alt="Image not available at this time" />
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-info active" aria-pressed="true" href="/home" data-dismiss="modal">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            $("#submit").on("click", function() {
                function validateForm() {
                    let isValid = true;
                    $(".form-control").each(function() {
                        if ($(this).val() === "") isValid = false;
                    });
                    $(".chosen-select").each(function() {
                        if ($(this).val() === "") isValid = false;
                    });
                    return isValid;
                }
                if (validateForm() === true) {
                    //console.log("validateForm()===true:" + validateForm());
                    let newFriend = {
                        name: $("#name").val().trim(),
                        photo: $("#photo").val().trim(),
                        scores: [
                            $("#q1").val(),
                            $("#q2").val(),
                            $("#q3").val(),
                            $("#q4").val(),
                            $("#q5").val(),
                            $("#q6").val(),
                            $("#q7").val(),
                            $("#q8").val(),
                            $("#q9").val(),
                            $("#q10").val()
                        ]
                    };
                    let currentURL = window.location.origin;
                    $.post(currentURL + "/api/friends", newFriend, function(data) {
                        $("#bestFriendName").text(data.name);
                        $("#bestFriendImg").attr("src", data.photo);
                        $("#bestFriendModal").modal("toggle");
                    });
                    $("#name").val("");
                    $("#photo").val("");
                    $("#q1").val("");
                    $("#q2").val("");
                    $("#q3").val("");
                    $("#q4").val("");
                    $("#q5").val("");
                    $("#q6").val("");
                    $("#q7").val("");
                    $("#q8").val("");
                    $("#q9").val("");
                    $("#q10").val("");
                } else {
                    alert("Please fill out all fields before submitting.")
                }
            });
        });
    </script>
</body>

</html>